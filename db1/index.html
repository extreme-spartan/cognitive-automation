<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="AI Bots Create, Deploy & Execute Automation(s) using Cognitive Conversation(s) and help Enterprise SRE & SME' scale new business requirements while keeping the overall resource cost low"><meta name=author content="Sridhar P Naidu"><link href=https://extreme-spartan.github.io/cognitive-automation/db1/ rel=canonical><link rel=icon href=../assets/favicon.png><meta name=generator content="mkdocs-1.4.3, mkdocs-material-8.3.4"><title>Db1 - ExtremeSpartan Cognitive Solutions - Deploy Automation as a Service</title><link rel=stylesheet href=../assets/stylesheets/main.4a0965b7.min.css><link rel=stylesheet href=../assets/stylesheets/palette.cbb835fc.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link rel=stylesheet href=../overrides/assets/stylesheets/main.82a244a8.min.css></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=green data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> </div> </aside> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="ExtremeSpartan Cognitive Solutions - Deploy Automation as a Service" class="md-header__button md-logo" aria-label="ExtremeSpartan Cognitive Solutions - Deploy Automation as a Service" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"> <!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--> <path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> ExtremeSpartan Cognitive Solutions - Deploy Automation as a Service </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Db1 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=green data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=violet data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../introduction/ class=md-tabs__link> Executive Summary </a> </li> <li class=md-tabs__item> <a href=../service-offerings/ class=md-tabs__link> Cognitive AI Automation as a Service Offerings </a> </li> <li class=md-tabs__item> <a href=../escape.html class=md-tabs__link> Congnitive AI Workbench </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="ExtremeSpartan Cognitive Solutions - Deploy Automation as a Service" class="md-nav__button md-logo" aria-label="ExtremeSpartan Cognitive Solutions - Deploy Automation as a Service" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"> <!-- Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--> <path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/> </svg> </a> ExtremeSpartan Cognitive Solutions - Deploy Automation as a Service </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Executive Summary <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Executive Summary" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Executive Summary </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../introduction/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../industrywise-overview/ class=md-nav__link> Industrywsie Overview </a> </li> <li class=md-nav__item> <a href=../ai-applications/ class=md-nav__link> AI Application Abilities </a> </li> <li class=md-nav__item> <a href=../business-use-cases/ class=md-nav__link> Business Use Cases </a> </li> <li class=md-nav__item> <a href=../benefits-of-ai-implementation/ class=md-nav__link> Benefits of AI Implementation </a> </li> <li class=md-nav__item> <a href=../case-studies/ class=md-nav__link> Case Studies </a> </li> <li class=md-nav__item> <a href=../implementation-strategy/ class=md-nav__link> Implementation Strategy </a> </li> <li class=md-nav__item> <a href=../roi-and-cost-analysis/ class=md-nav__link> ROI and Cost Analysis </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../service-offerings/ class=md-nav__link> Cognitive AI Automation as a Service Offerings </a> </li> <li class=md-nav__item> <a href=../escape.html class=md-nav__link> Congnitive AI Workbench </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc hidden> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Db1</h1> <script src=https://cdn.jsdelivr.net/npm/chart.js></script> <style>
    /* Modal styles */
    .modal {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.7);
    }

    .modal-content {
        background-color: white;
        margin: 5% auto;
        padding: 15px;
        border: 1px solid #888;
        width: 70%;
    }

    .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    /* Slide-in pane styles */
    /* .slide-pane {
        position: fixed;
        top: 0;
        right: -400px;
        width: 400px;
        height: 100%;
        background-color: white;
        box-shadow: -3px 0 6px rgba(0, 0, 0, 0.3);
        transition: right 0.3s ease-in-out;
    } */

    .pane-content {
        padding: 10px;
    }

    /* .close-slide {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
    } */
    .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1; /* Sit on top */
        padding-top: 10px; /* Location of the box */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    }

    /* Modal content */
    .modal-content {
        background-color: #fefefe;
        margin: auto;
        padding: 40px;
        border: 1px solid #888;
        max-width: 90%; /* Set a maximum width */
        max-height: 80%; /* Set a maximum height */
        overflow: auto; /* Allow vertical scrolling if content overflows */
    }

    /* Close button */
    .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }

    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }

    </style> <p></head></p> <body> <!-- Modal --> <div id=myModal class=modal> <div class=modal-content> <span class=close>&times;</span> <canvas id=myChart></canvas> </div> </div> <canvas id=stackedChart></canvas> <button id=recordBtn>Start Meeting</button><input id=chatInput type=text class=form-control placeholder="Type in text here .. " autofocus=autofocus onkeyup=send_txt(id) oninput=countCharacters() style="width: 100%;"> <script>

    const synth = window.speechSynthesis; // Initialize the synth object
    const canvas = document.getElementById("stackedChart");

    var vmData = [ 
        {
            squad_name: "APPS",
            incidents: {
                New: { P1: 2, P2: 3, P3: 6, P4: 50, P5: 60  },
                "In Progress": { P1: 2, P2: 5, P3: 7, P4: 3, P5: 1 },
                Resolved: { P1: 8, P2: 12, P3: 18, P4: 10, P5: 5 },
                Closed: { P1: 3, P2: 6, P3: 8, P4: 4, P5: 2 }
            }
        },
        {
            squad_name: "BACKUP",
            incidents: {
                New: { P1: 5, P2: 10, P3: 15, P4: 8, P5: 3 },
                "In Progress": { P1: 2, P2: 5, P3: 7, P4: 3, P5: 1 },
                Resolved: { P1: 8, P2: 12, P3: 18, P4: 10, P5: 5 },
                Closed: { P1: 3, P2: 6, P3: 8, P4: 4, P5: 2 }
            }
        },
        {
            squad_name: "LINUX",
            incidents: {
                New: { P1: 5, P2: 10, P3: 15, P4: 8, P5: 3 },
                "In Progress": { P1: 2, P2: 5, P3: 7, P4: 3, P5: 1 },
                Resolved: { P1: 8, P2: 12, P3: 18, P4: 10, P5: 5 },
                Closed: { P1: 3, P2: 6, P3: 8, P4: 4, P5: 2 }
            }
        },
        {
            squad_name: "NETWORK",
            incidents: {
                New: { P1: 5, P2: 10, P3: 15, P4: 8, P5: 3 },
                "In Progress": { P1: 2, P2: 5, P3: 7, P4: 3, P5: 1 },
                Resolved: { P1: 8, P2: 12, P3: 18, P4: 10, P5: 5 },
                Closed: { P1: 3, P2: 6, P3: 8, P4: 4, P5: 2 }
            }
        },
        {
            squad_name: "SECURITY",
            incidents: {
                New: { P1: 2, P2: 3, P3: 6, P4: 50, P5: 60  },
                "In Progress": { P1: 2, P2: 5, P3: 7, P4: 3, P5: 1 },
                Resolved: { P1: 8, P2: 12, P3: 18, P4: 10, P5: 5 },
                Closed: { P1: 3, P2: 6, P3: 8, P4: 4, P5: 2 }
            }
        },
        {
            squad_name: "STORAGE",
            incidents: {
                New: { P1: 5, P2: 10, P3: 15, P4: 8, P5: 3 },
                "In Progress": { P1: 2, P2: 5, P3: 7, P4: 3, P5: 1 },
                Resolved: { P1: 8, P2: 12, P3: 18, P4: 10, P5: 5 },
                Closed: { P1: 3, P2: 6, P3: 8, P4: 4, P5: 2 }
            }
        },
        {
            squad_name: "WINDOWS",
            incidents: {
                New: { P1: 5, P2: 10, P3: 15, P4: 8, P5: 3 },
                "In Progress": { P1: 2, P2: 5, P3: 7, P4: 3, P5: 1 },
                Resolved: { P1: 8, P2: 12, P3: 18, P4: 10, P5: 5 },
                Closed: { P1: 3, P2: 6, P3: 8, P4: 4, P5: 2 }
            }
        }
    ];

    // Extract unique categories and severities
    var categories = Object.keys(vmData[0].incidents);
    var severities = Object.keys(vmData[0].incidents[categories[0]]);

    // alert(severities)

    var storedValues = [];
    var storedValues2 = [];
    // Create labels for the chart (squad names)
    // var squadNames = vmData.map(squad => squad.squad_name);
    // Extract unique squad names
    var squadNames = vmData.map(item => item.squad_name);

    // Create data for the chart
    var datasets = [];
    var categoryColors = {
        New: 'red',
        "In Progress": 'yellow',
        Resolved: 'green',
        Closed: 'blue',
        Predicted: 'cyan' // New color for predicted incidents
    };
    // Function to get color based on category
    function getColor(category, severity) {
        // getColor2(severity);
        // Return colors based on category
        // You can customize the colors here
        // alert(category +" "+severity);
        if (category === "New") return "rgba(255, 0, 0, 0.8)";
        if (category === "In Progress") return "rgba(255, 165, 0, 0.8)";
        if (category === "Resolved") return "rgba(255, 255, 0, 0.8)";
        if (category === "Closed") return "rgba(0, 128, 0, 0.8)";
        // if (category === "Re_Opened") return "rgba(0, 0, 255, 0.8)";
        if (severity === "P1") return "rgba(55, 0, 0, 0.8)";
        if (severity === "P2") return "rgba(255, 165, 0, 0.8)";
        if (severity === "P3") return "rgba(255, 155, 0, 0.8)";
        if (severity === "P4") return "rgba(10, 128, 0, 0.8)";
        if (severity === "P5") return "rgba(0, 0, 25, 0.8)";
    }

    var labels = vmData.map(vm => vm.vm);
    var datasets = categories.map(category => {
        return {
            // label: [category, severities],
            label: [category],
            data: vmData.map(vm => calculateCategoryTotal(vm.incidents, category)),
            backgroundColor: severities.map(severity => getColor(category)),
            borderWidth: 1
        };
    });        
    var pi = [];
    // Function to calculate total incidents for a category across all severities
    function calculateCategoryTotal(incidents, category) {
        totalSum = Object.values(incidents[category]).reduce((total, severity) => total + severity, 0);
        // alert(totalSum)
        return totalSum;
    }

    // Create a bar chart using Chart.js
    var ctx = canvas.getContext('2d');

    const config = {
        type: 'bar',
        data: {
            labels: squadNames,
            datasets: datasets
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            },
        animation: {
            duration: 0.1,
            onComplete: function (chart) {

                const datasets = stackedChart.data.datasets;
                ctx.font = "12px sans-serif";
                ctx.fillStyle = "black";
                ctx.textAlign = "center";
                // var squadsTeams = squadNames;
                // Extract unique squad names
                var squadsTeams = vmData.map(item => item.squad_name);

                for (let i = 0; i < datasets.length; i++) {
                    console.log(datasets.length);

                    const meta = stackedChart.getDatasetMeta(i);
                    meta.data.forEach((bar, index) => {
                        var squad = squadsTeams[index];
                        // alert(squad)

                        var data = datasets[i].data[index];;
                        var lbl = datasets[i].label;

                        const value = datasets[i].data[index];
                        const x = bar.x;
                        const y = bar.y +7 ; // Adjust the vertical position
                        console.log(squad, lbl, value);
                        ctx.fillText(value, x, y);
                        if (storedValues.length < 35) {
                        storedValues.push({ squad: squad, label: lbl, data: data, x: x, y: y });
                        console.log(storedValues.length);

                        }
                    });
                }
            }
        },
        plugins: {
            title: {
                display: true,
                color: "blue",
                font: {size: 14},
                text: 'Daily Incident Status',
                padding: {
                    top: 10,
                    bottom: 10
                },

            }
        }
    }
};

const stackedChart = new Chart(canvas, config);

// Sample past data for prediction
const pastData = [100, 150, 200, 250, 300, 350, 400];

// Function to predict severity based on past performance
function predictSeverity(pastData) {
    // Add your prediction logic here (e.g., using machine learning models)

    // For simplicity, let's assume we add 10% to the past data for prediction
    return pastData.map(value => Math.round(value * 1.1));
}

// Calculate predicted incidents
var predictedData = vmData.map(vm => Math.round(calculateCategoryTotal(vm.incidents, 'New') * 1.1));
// var predictedData = vmData.map(squad => severities.map(severity => Math.round(squad.incidents.New[severity] * 1.1)));
// alert(predictedData)

datasets.push({
    label: 'Predicted',
    data: [].concat.apply([], predictedData), // Flatten the nested array
    backgroundColor: categoryColors.Predicted,
    // borderColor: categoryColors.Predicted,
    borderWidth: 1
});

stackedChart.update();

// Function to retrieve values with a delay
function retrieveValuesWithDelay(delay) {
    // Sort the storedValues array based on the "squad" property
    storedValues.sort((a, b) => a.squad.localeCompare(b.squad));

    // Now you can retrieve the sorted values with a delay
    storedValues.forEach((item, index) => {
        const squad = item.squad;
        const label = item.label;
        const data = item.data;
        const x = item.x;
        const y = item.y;

        // Retrieve the values after a delay of 7 seconds for each iteration
        setTimeout(() => {
            console.log(`Squad: ${squad}, Label: ${label}, Data: ${data}, X: ${x}, Y: ${y}`);
            var mouseMoveEvent = new MouseEvent("mousemove", {
                        bubbles: true,
                        cancelable: true,
                        clientX: x,
                        clientY: y + 3,
                    });

                    canvas.dispatchEvent(mouseMoveEvent);


                    // Use text-to-speech to announce the status and severity for each squad
                    if (label == "New") {
                        announcementText = `For ${squad}: we have ${data}: ${label} incidents.`;
                        canvas.click();
                    } else if (label == "Resolved") {
                        announcementText = `We have ${data} incidents ${label} for ${squad}.`;
                    } else if (label == "In Progress") {
                        announcementText = `The ${squad} Squad has ${data} incidents which are ${label}`;
                    } else if (label == "Closed") {
                        announcementText = `Total incidents ${label} by ${squad} Squad are around ${data}.`;
                    } else if (label == "Re-opened") {
                        announcementText = `${squad}: ${label}: ${data} incidents re-opened.`;
                    } else if (label == "Predicted") {
                        announcementText = `The Overall ${label}: number of incidents for ${squad} Squad is around ${data}.`;
                    } else {
                        announcementText = `${squad}: ${label}: ${data} incidents.`;
                    }

                    speakWithBuffer(announcementText);
                    if (index == 34){
                        recordBtn.click();
                    }

        }, index * 7000); // Delay of 7 seconds (7000 milliseconds)
    });

}

    // Announce the predicted severity after 3 seconds
    setTimeout(retrieveValuesWithDelay, 7000);

    // const canvas = document.getElementById('canvas');
    const context = canvas.getContext("2d");
    const recordBtn = document.querySelector("button");

    let recording = false;
    let mediaRecorder;
    let recordedChunks = [];
    let audioBuffers = [];

    recordBtn.addEventListener("click", async () => {
        recording = !recording;
        if (recording) {
            recordBtn.textContent = "Stop Meeting";
            const stream = canvas.captureStream(25);
            mediaRecorder = new MediaRecorder(stream, {
                mimeType: 'video/webm;codecs=vp8',
                ignoreMutedMedia: true
            });
            recordedChunks = [];
            audioBuffers = [];

            mediaRecorder.ondataavailable = (e) => {
                if (e.data.size > 0) {
                    recordedChunks.push(e.data);
                }
            };

            mediaRecorder.start();

            // Start recording canvas events and text-to-speech audio
            startCanvasEventRecording();

        } else {
            recordBtn.textContent = "Start Meeting";
            mediaRecorder.stop();

            // Stop recording canvas events and text-to-speech audio
            stopCanvasEventRecording();

        }
    });

// Function to start recording canvas events and text-to-speech audio
function startCanvasEventRecording() {
// var delay = 3000;
speakWithBuffer("Hi Squad Leaders and others, Thanks for joining the Daily Incident Status Meeting.");
setTimeout(retrieveValuesWithDelay, 5000);
// canvas.addEventListener("mousemove", handleMouseMove);
}

// Function to stop recording canvas events and text-to-speech audio
async function stopCanvasEventRecording() {
var storedValues = [];
const announcementText = "Thanks for attending the meeting, the session is now open for questions and clarification.";
const bufferArray = await speakWithBuffer(announcementText);
console.log("Received bufferArray:", bufferArray);
audioBuffers.push(...(Array.isArray(bufferArray) ? bufferArray : [bufferArray]));

// Ensure that audioBuffers are populated before proceeding
if (recordedChunks.length > 0 && audioBuffers.length > 0) {
    // const combinedBlob = await mergeAudioBuffers(audioBuffers) //mergeVideoAndAudio(recordedChunks, audioBuffers);
    const combinedBlob = await mergeVideoAndAudio(recordedChunks, audioBuffers);
    const url = URL.createObjectURL(combinedBlob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "canvas_recording_with_audio.webm";
    a.click();
    URL.revokeObjectURL(url);

} else {
    console.log("audioBuffers array is empty.");
}
}

// Function to merge video and audio
async function mergeVideoAndAudio(videoChunks, audioBuffers) {
const videoBlob = new Blob(videoChunks, { type: 'video/webm' });

const audioContext = new (window.AudioContext || window.webkitAudioContext)(); // Create an AudioContext

// Check if audioBuffers is an array and not empty
if (!Array.isArray(audioBuffers) || audioBuffers.length === 0) {
    throw new Error('Invalid or empty audioBuffers array.');
}

// Create an OfflineAudioContext for rendering the combined audio
const offlineAudioContext = new OfflineAudioContext({
    numberOfChannels: audioBuffers[0].numberOfChannels,
    length: audioBuffers[0].length * audioBuffers.length,
    sampleRate: audioBuffers[0].sampleRate,
});

audioBuffers.forEach((audioBuffer, index) => {
    const source = offlineAudioContext.createBufferSource();
    source.buffer = audioBuffer;
    source.connect(offlineAudioContext.destination);
    source.start(index * audioBuffer.length);
});

// Start the rendering process
const renderedAudioBuffer = await offlineAudioContext.startRendering();

const audioBufferArrayBuffer = audioBufferToWavArrayBuffer(renderedAudioBuffer);
const audioUint8Array = new Uint8Array(audioBufferArrayBuffer);

const audioBlob = new Blob([audioUint8Array], { type: 'audio/wav' });

return new Promise((resolve) => {
    const reader = new FileReader();
    reader.onload = async () => {
        const audioArrayBuffer = reader.result;
        const videoArrayBuffer = await videoBlob.arrayBuffer();
        const videoUint8Array = new Uint8Array(videoArrayBuffer);

        const combinedUint8Array = new Uint8Array(videoUint8Array.length + audioArrayBuffer.byteLength);
        combinedUint8Array.set(videoUint8Array, 0);
        combinedUint8Array.set(new Uint8Array(audioArrayBuffer), videoUint8Array.length);

        resolve(new Blob([combinedUint8Array], { type: 'video/webm' }));
    };
    reader.readAsArrayBuffer(audioBlob);
});
}


// Handle mouse move event
function handleMouseMove(event) {
// ... (your canvas event handling logic)

const announcementText = "Your announcement text here";
speakWithBuffer(announcementText).then(bufferArray => {
    audioBuffers.push(...bufferArray);
});
}

// Function to speak and return an audio buffer
async function speakWithBuffer(text) {
return new Promise(async (resolve, reject) => {
    try {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';

        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        const analyserNode = audioContext.createAnalyser();
        analyserNode.fftSize = 2048;
        const bufferLength = analyserNode.frequencyBinCount;
        const dataArray = new Float32Array(bufferLength);

        const source = audioContext.createBufferSource();
        source.connect(analyserNode);
        analyserNode.connect(audioContext.destination);

        const chunks = [];

        utterance.onend = async () => {
            source.stop();
            analyserNode.disconnect();
            const audioBuffer = audioContext.createBuffer(1, chunks.length * bufferLength, audioContext.sampleRate);
            const audioBufferChannelData = audioBuffer.getChannelData(0);

            for (let i = 0; i < chunks.length; i++) {
                audioBufferChannelData.set(chunks[i], i * bufferLength);
            }

            resolve(audioBuffer);
        };

        source.onended = () => {
            resolve(null); // Resolve with null if playback ends unexpectedly
        };

        source.start();

        // Capture audio data using analyserNode
        function captureAudioData() {
            analyserNode.getFloatTimeDomainData(dataArray);
            chunks.push(new Float32Array(dataArray));
            requestAnimationFrame(captureAudioData);
        }

        captureAudioData();

        synth.speak(utterance);
    } catch (error) {
        console.error("Error in speakWithBuffer:", error);
        reject(error);
    }
});
}
function audioBufferToWavArrayBuffer(audioBuffer) {
const numChannels = audioBuffer.numberOfChannels;
const sampleRate = audioBuffer.sampleRate;
const numFrames = audioBuffer.length;
const samples = new Float32Array(numFrames * numChannels);

for (let channel = 0; channel < numChannels; channel++) {
    const channelData = audioBuffer.getChannelData(channel);
    samples.set(channelData, channel * numFrames);
}

const buffer = new ArrayBuffer(44 + samples.length * 2);
const view = new DataView(buffer);

// RIFF chunk descriptor
writeString(view, 0, 'RIFF');
view.setUint32(4, 36 + samples.length * 2, true);
writeString(view, 8, 'WAVE');

// Format chunk
writeString(view, 12, 'fmt ');
view.setUint32(16, 16, true);
view.setUint16(20, 1, true);
view.setUint16(22, numChannels, true);
view.setUint32(24, sampleRate, true);
view.setUint32(28, sampleRate * numChannels * 2, true);
view.setUint16(32, numChannels * 2, true);
view.setUint16(34, 16, true);

// Data chunk
writeString(view, 36, 'data');
view.setUint32(40, samples.length * 2, true);

// Write the PCM samples
floatTo16BitPCM(view, 44, samples);

return buffer;
}

function writeString(view, offset, string) {
for (let i = 0; i < string.length; i++) {
    view.setUint8(offset + i, string.charCodeAt(i));
}
}

function floatTo16BitPCM(output, offset, input) {
for (let i = 0; i < input.length; i++, offset += 2) {
    const s = Math.max(-1, Math.min(1, input[i]));
    output.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7FFF, true);
}
}

canvas.addEventListener("click", function(evt) {
    var activePoint = stackedChart.getElementsAtEventForMode(evt, 'nearest', { intersect: true }, true);

    if (activePoint.length > 0) {
        var datasetIndex = activePoint[0].datasetIndex;
        var selectedIndex = activePoint[0].index;
        var squad = stackedChart.data.labels[selectedIndex];
        var label = stackedChart.data.datasets[datasetIndex].label;
        var value = stackedChart.data.datasets[datasetIndex].data[selectedIndex];
        // alert(`Squad: ${squad}\nSeverity: ${label}\nCount: ${value}`);
        console.log('>>>>>>>>>>>>>>>>>>>>>>', squad);
        var modal = document.getElementById("myModal");
        var span = document.getElementsByClassName("close")[0];
        modal.style.display = "block";

        // For Slide-in Pane
        // var slidePane = document.getElementById("slidePane");
        // slidePane.style.right = "0";
        var sn = vmData.map(vm => vm.squad_name);

        function calculateSeverityTotal(vmData, squad, category, severity) {
            const squadData = vmData.find(vm => vm.squad_name === squad);
            if (squadData) {
                return squadData.incidents[category][severity];
            }
            return 0;
        }

        var datasets = severities.map(severity => {
            return {
                label: severity,
                data: categories.map(category => calculateSeverityTotal(vmData, squad, category, severity)),
                backgroundColor: getColor(severity),
                borderWidth: 1
            };
        });



        var chartData2 = {
            type: 'bar',
            scales: {
                x: {
                    stacked: false
                },
                y: {
                    stacked: false
                }
            },
            data: {
                labels: categories,
                datasets: datasets
            },
            options: {
                "animation": {
                "duration": 0.1,
                onComplete: function (chart) {
                    const datasets = myChart.data.datasets;

                    ctx2.font = "12px sans-serif";
                    ctx2.fillStyle = "black";
                    ctx2.textAlign = "center";
                    // var squadsTeams = stackedChart.data.labels;

                    for (let i = 0; i < datasets.length; i++) {
                        const meta = myChart.getDatasetMeta(i);
                        meta.data.forEach((bar, index) => {
                            // var squad = squadsTeams[index];
                            // var data = datasets[i].data[index];;
                            // var lbl = datasets[i].label;

                            const value = datasets[i].data[index];
                            const x = bar.x;
                            const y = bar.y +7 ; // Adjust the vertical position

                            ctx2.fillText(value, x, y);
                            // storedValues.push({ squad: squad, label: lbl, data: data, x: x, y: y });
                        });
                    }
                }
                },
                plugins: {
                    title: {
                        display: true,
                        color: "blue",
                        font: {size: 14},
                        text: 'Incident Severity Break-up Report for: '+squad+ ' Squad',
                        padding: {
                            top: 10,
                            bottom: 10
                        },

                    }
                }
            }
        };

        var canvas2 = document.getElementById('myChart');
        var ctx2 = canvas2.getContext('2d');
        var myChart = new Chart(ctx2, chartData2);

        // Close modal or slide-in pane when the close button is clicked
        span.onclick = function() {
            modal.style.display = "none";
            if (typeof myChart !== 'undefined' && myChart !== null) {
                myChart.destroy(); // Destroy the existing chart instance
                    // Restore canvas dimensions to initial values
                myChartCanvas.width = initialMyChartWidth;
                myChartCanvas.height = initialMyChartHeight;
            }
            // slidePane.style.right = "-400px";
        };
    }
});



</script> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <b>SPN</b> <div class="md-footer-meta md-typeset"> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["content.code.annotate", "content.tooltips", "navigation.indexes", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.85cb4492.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../assets/javascripts/bundle.431f3d41.min.js></script> <script src=../overrides/assets/javascripts/bundle.1ff6d521.min.js></script> </script> </body> </html>